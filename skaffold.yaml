# Skaffold is used for locally building, tagging and running containers during development
# 
# File generated by `skaffold init` (kustomize aware)
# Build containers and run cluster: `skaffold run`
# Build containers and run cluster on source code change: `skaffold dev`
# NOTE: building in haskell initially takes a LONG time, then caching makes life easier

apiVersion: skaffold/v2beta28
kind: Config
metadata:
  name: learning-k-s
build:
  artifacts:
  - image: ghcr.io/pmihaly/learning-k8s
    docker:
      dockerfile: Dockerfile
deploy:
  kustomize:
    paths:
    - k8s/environments/dev
profiles:
- name: base
  deploy:
    kustomize:
      paths:
      - k8s/base
- name: postgres
  deploy:
    kustomize:
      paths:
      - k8s/base/postgres
- name: redis
  deploy:
    kustomize:
      paths:
      - k8s/base/redis
- name: server
  deploy:
    kustomize:
      paths:
      - k8s/base/server
- name: prod
  deploy:
    kustomize:
      paths:
      - k8s/environments/prod
